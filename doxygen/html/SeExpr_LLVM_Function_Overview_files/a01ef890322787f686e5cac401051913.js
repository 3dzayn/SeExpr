jive.namespace("ShareApp");jive.ShareApp.ShareSource=jive.RestService.extend(function(a){this.init=function(){this.suppressGenericErrorMessages()};this.save=function(b,f,d){var e=new jive.conc.Promise(),c=this;$j.ajax({type:"POST",url:jive.rest.url("/objects/")+b+"/"+f+"/shares",dataType:"json",data:JSON.stringify(d),contentType:"application/json; charset=utf-8",success:function(g,i,h){if(g){c.merge(d,g)}e.emitSuccess(d)},error:c.errorCallback(e),timeout:30000});return e};this.get=function(b,e){var d=new jive.conc.Promise(),c=this;$j.ajax({type:"GET",url:jive.rest.url("/objects/")+b+"/"+e+"/sharetemplate",dataType:"json",data:{},contentType:"application/json; charset=utf-8",success:function(f,h,g){d.emitSuccess(f)},error:c.errorCallback(d),timeout:30000});return d}});
;
if(typeof jive=="undefined"){var jive={}}if(typeof jive.soy=="undefined"){jive.soy={}}if(typeof jive.soy.share=="undefined"){jive.soy.share={}}jive.soy.share.control=function(A,C){var B=C||new soy.StringBuilder();B.append('<a href="#" class="',(A.type=="text")?"share-link j-meta-control ":(A.type=="largeButton")?"j-social-action ":"",(A.classes)?soy.$$escapeHtmlAttribute(A.classes):"",'" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("share.link.title"),[])),'" data-command="share" data-object-type="',soy.$$escapeHtmlAttribute(A.objectType),'" data-object-id="',soy.$$escapeHtmlAttribute(A.objectId),'">',(A.icon)?"<span"+((A.type=="smallButton")?' class="j-ui-elem"':"")+'><span class="jive-icon-med jive-icon-share"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.link"),[]))+"</span>":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.link"),[])),"</a>");return C?"":B.toString()};jive.soy.share.share=function(A,C){var B=C||new soy.StringBuilder();B.append('<div class="jive-modal j-modal" id="jive-modal-share"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.title"),[A.objectNameLower])),'</h2></header><label class="j-508-label" id="close-modal-508">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'</label><a href="#" class="j-modal-close-top close" aria-labelledby="close-modal-508" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'  <span class="j-close-icon j-ui-elem" role="img"></span></a><section class="jive-modal-content j-invite-modal clearfix"><div id="share-error" class="jive-error-box" style="display:none" aria-live="polite" aria-atomic="true" ></div><form class="j-form">',(A["private"])?'<p class="j-info"><span class="j-info-icon j-ui-elem"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.private.access"),[A.objectNameLower]))+"</p>":"",'<label for="share-users">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.people.label"),[]))," (",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.invite.nonusers.noimport.label"),[])),')</label><div class="ie-zindex-fix j-form-exp font-color-meta-light"><strong>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tips.onboarding.tip5.body3"),[]))," </strong>");jive.UserPicker.soy.inputPlaceholder({userAllowed:true,emailAllowed:A.externallyShareable,multiple:true},B);B.append('</div><div class="j-user-input-typeahead"><input type="text" name="share-users" id="share-users" class="j-autocomplete-input j-user-autocomplete j-autocomplete-jive-chooser-input jive-form-element-text j-ui-elem" autocomplete="on" role="combobox"/></div><div class="ie-zindex-fix j-form-exp j-noimport">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.invite.nonusers.noimport.explanation"),[])),'</div><p><label for="jive-send-content-not-message">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.message.label"),[])),'</label><textarea name="message" class="jive-form-element-textarea font-color-normal" id="jive-send-content-not-message">',A.message,'</textarea></p><p><button type="submit" id="share-content-submit" name="share-content-submit" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.submit.button"),[])),'</button><button type="button" class="close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></p></form></section></div>");return C?"":B.toString()};jive.soy.share.shareConfirmation=function(A,C){var B=C||new soy.StringBuilder();B.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.confirm"),[])),"</p>");return C?"":B.toString()};jive.soy.share.secretGroupMessage=function(A,C){var B=C||new soy.StringBuilder();B.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.secretgroup"),[])),"</p>");return C?"":B.toString()};jive.soy.share.send_private_msg=function(A,C){var B=C||new soy.StringBuilder();B.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.private.autoaccess"),[A.objectName])));return C?"":B.toString()};jive.soy.share.userWithoutPermission=function(A,C){var B=C||new soy.StringBuilder();B.append('<div class="js-share-msg j-tips">');if(A.user.anonymous||A.user.external){if(!A.invitationsEnabled){B.append((A.attachmentAvailable)?'<p class="j-warn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.attachment"),[]))+"<p>":'<p class="j-warn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.noattachment"),[]))+"<p>")}else{if(A["private"]&&A.editor){B.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.private"),[])),"<p>");jive.soy.share.attachmentLinks(A.user,B)}else{if(A.attachmentAvailable){B.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.attachment"),[])),"<p>");jive.soy.share.attachmentLinks(A.user,B)}else{B.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.noattachment"),[])),"<p>");jive.soy.share.emailLinks(A.user,B)}}}}else{B.append((A["private"]&&A.editor)?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.private"),[])):(A.attachmentAvailable)?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.attachment"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.noattachment"),[])))}B.append("</div>");return C?"":B.toString()};jive.soy.share.attachmentLinks=function(A,C){var B=C||new soy.StringBuilder();B.append('<p><a href="#" class="js-notify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(A.email),'" ',(A.notified)?'style="display:none"':""," >",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.attachment.send.link"),[])),'</a><a href="#" class="js-unnotify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(A.email),'" ',(!A.notified)?'style="display:none"':""," >",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.attachment.remove.link"),[])),"</a><p>");return C?"":B.toString()};jive.soy.share.emailLinks=function(A,C){var B=C||new soy.StringBuilder();B.append('<p><a href="#" class="js-notify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(A.email),'" ',(A.notified)?'style="display:none"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.email.send.link"),[])),'</a><a href="#" class="js-unnotify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(A.email),'" ',(!A.notified)?'style="display:none"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.email.remove.link"),[])),"</a><p>");return C?"":B.toString()};jive.soy.share.listWithoutPermission=function(A,C){var B=C||new soy.StringBuilder();B.append('<div class="js-share-msg j-tips">',(A["private"]&&A.editor)?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.private"),[])):(A.attachmentAvailable)?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.attachment"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.noattachment"),[])),"</div>");return C?"":B.toString()};jive.soy.share.usersNotRelated=function(A,C){var B=C||new soy.StringBuilder();B.append('<p class="j-warn"><span class="jive-icon-sml jive-icon-redalert"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.notrelated"),[])),"</p>");return C?"":B.toString()}
;
if(!jive.share){jive.share=(function(a){jive.dispatcher.listen("share",function(b){a=a||new jive.ShareApp.Main();a.showModal(b.objectId,b.objectType)});return{}})(undefined)};
;
jive.namespace("ShareApp");jive.ShareApp.ShareView=jive.oo.Class.extend(function(a){jive.conc.observable(this);this.init=function(){this.recipients=[];this.options={}};a.submitShare=function(g,c,e,f){var b=this;var d={message:$j("#jive-send-content-not-message").val(),recipients:b.buildRecipientArray(),subject:$j("#jive-send-content-not-subject").val()};d.message=d.message.replace(/</g,"&lt;").replace(/>/g,"&gt;");b.emitP("share",c,g,d).addCallback(function(){$j(jive.soy.share.shareConfirmation({objectName:f})).message({style:"success"});e.trigger("close");if(b.recipients.some(function(h){return h.id!==window._jive_current_user.ID})){jive.dispatcher.dispatch("trial.share.created");jive.dispatcher.dispatch("trial.updatePercentComplete")}b.recipients=[]}).addErrback(function(i){var h=i?$j("<p>"+i+"</p>"):$j(jive.error.rest.soy.errorUpdating({href:window.location}));h.message({showClose:true,style:"error"});e.find("input, button").prop("disabled",false)})};a.buildRecipientArray=function(){var b=this;var c=[];this.checkExternalUsers(this.userPicker.getSelectedUsersAndLists(true));return this.recipients.map(function(d){return{identifier:d.id!=-1?d.id:d.email,notified:d.notified}})};a.checkExternalUsers=function(d){var b=this;$j("#jive-include-attach-div").hide();d.users.forEach(function(e){if(e.id==-1||!e.entitled){$j("#jive-include-attach-div").show()}});this.recipients=this.recipients.filter(function(e){return d.users.some(function(f){return f.email===e.email})});var c=this.addedRecipients(d.users);this.recipients=this.recipients.concat(c)};a.addedRecipients=function(c){var b=this;return c.filter(function(d){return !b.recipients.some(function(e){return d.email===e.email})}).map(function(d){return $j.extend({},d,{notified:false})})};a.recipient=function(b){return this.recipients.filter(function(c){return c.email===b})};a.notifyUser=function(b,c){this.recipient(b).forEach(function(d){d.notified=c});$j(".js-notify-user").toggle();$j(".js-unnotify-user").toggle()};this.openShareModal=function(d,c){var b=this;b.emitP("prepareShare",c,d).addCallback(function(h){if(!b.open){b.open=true;if(h.invitationsEnabled){b.options.invitationsEnabled=true}b.recipients=[];if(h.secretGroup){$j(jive.soy.share.secretGroupMessage()).message({showClose:true,style:"error"})}else{var f=$j(jive.soy.share.share(h));f.lightbox_me({destroyOnClose:true,centered:true,closeClick:false,closeEsc:false,closeFocusSelector:jive.Accessibility.hasStackedFocus()?jive.Accessibility.popFocus():'a.[data-command="share"][data-object-id="'+d+'"][data-object-type="'+c+'"]',onLoad:function(){jive.dispatcher.dispatch("trial.share.modal.loaded")},onClose:function(){b.cleanupModal()}});f.find("form").submit(function(){$j(this).find("input,button").prop("disabled",true);b.submitShare(d,c,f,h.objectNameCapital);return false});var e=new jive.UserPicker.Main({multiple:true,listAllowed:true,emailAllowed:h.externallyShareable,message:"",object:{objectID:d,objectType:c},entitlement:"VIEW",$input:$j("#share-users"),canInvitePartners:h.attachmentAvailable,canInviteJustPartners:false,canInvitePreprovisioned:true,relatedMessage:$j(jive.soy.share.usersNotRelated()),userMessages:[b.getUserPermissionsMessage(h)],listMessages:[b.getListPermissionsMessage(h)],placeholder:" "});e.addListener("selectedUsersChanged",function(i){b.checkExternalUsers(i)});b.userPicker=e;var g=$j("body");g.delegate(".js-notify-user","click",function(i){b.notifyUser($j(this).data("user-identifier"),true);i.preventDefault()});g.delegate(".js-unnotify-user","click",function(i){b.notifyUser($j(this).data("user-identifier"),false);i.preventDefault()})}}}).addErrback(function(f){var e=f?$j("<p>"+f+"</p>"):$j(jive.error.rest.soy.errorFinding({href:window.location}));e.message({showClose:true,style:"error"})})};a.cleanupModal=function(){var b=this;$j(".js-userpicker-user-msg").trigger("close");var c=$j("body");c.undelegate(".js-notify-user","click");c.undelegate(".js-unnotify-user","click");b.open=false};a.getUserPermissionsMessage=function(c){var b=this;return{type:"warn",render:function(d){d.notified=b.recipient(d.email).some(function(f){return f.notified});var e=$j.extend({user:d},c);return jive.soy.share.userWithoutPermission(e)}}};a.getListPermissionsMessage=function(c){var b=this;return{type:"warn",render:function(){return jive.soy.share.listWithoutPermission(c)}}}});
;
jive.namespace("ShareApp");jive.ShareApp.Main=jive.oo.Class.extend(function(){this.init=function(c){var b=c||{};var a=b.source||new jive.ShareApp.ShareSource();this.view=new jive.ShareApp.ShareView();this.view.addListener("prepareShare",function(d,f,e){a.get(d,f).addCallback(e.emitSuccess.bind(e)).addErrback(e.emitError.bind(e))});this.view.addListener("share",function(d,g,e,f){a.save(d,g,e).addCallback(f.emitSuccess.bind(f).aritize(0)).addErrback(f.emitError.bind(f))})};this.showModal=function(b,a){this.view.openShareModal(b,a)}});
;
if(typeof jive=="undefined"){var jive={}}if(typeof jive.socialgroups=="undefined"){jive.socialgroups={}}if(typeof jive.socialgroups.soy=="undefined"){jive.socialgroups.soy={}}jive.socialgroups.soy.leaveGroup=function(A,C){var B=C||new soy.StringBuilder();B.append('<div class="jive-modal jive-modal-medium" id="jive-modal-leave-group"><header>',(A.pendingApproval)?'<h2 class="jive-modal-title jive-modal-title-leave-group">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.cancel"),[]))+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.colon"),[]))+" "+soy.$$escapeHtml(A.groupName)+"</h2>":'<h2 class="jive-modal-title jive-modal-title-leave-group">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.title"),[]))+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.colon"),[]))+" "+soy.$$escapeHtml(A.groupName)+"</h2>",'</header><label class="j-508-label" id="close-modal-508">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'</label><a href="#" class="j-modal-close-top close" aria-labelledby="close-modal-508" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'  <span class="j-close-icon  j-ui-elem"></span></a><!-- Manage categories listing --><section class="jive-modal-content j-modal-content-text jive-modal-leave-group clearfix">',(A.canLeaveSocialGroup)?((A.pendingApproval)?"<h3>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.canceljoin"),[A.groupName]))+"</h3>"+((A.requiresApproval)?"<p>"+soy.$$escapeHtml(A.leaveI18n)+"</p>":""):"<h3>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.confirm"),[A.groupName]))+"</h3>"+((A.requiresApproval)?"<p>"+soy.$$escapeHtml(A.leaveI18n)+"</p>":"")+"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.follow.remove"),[]))+"</p>")+'<div class="jive-form-buttons"><button type="button" class="j-btn-callout" id="group-leave-submit">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.accept"),[]))+'</button><button type="button" class="jive-modal-close close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[]))+"</button></div>":(A.onlyOneOwner)?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.onlyowner"),[]))+"</p><p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.onlyowner.info"),[]))+'</p><div class="jive-form-buttons"><button type="button" class="jive-modal-close close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[]))+"</button></div>":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.already.gone"),[])),"</section></div>");return C?"":B.toString()};jive.socialgroups.soy.joinConfirmation=function(A,C){var B=C||new soy.StringBuilder();B.append((A.pendingApproval)?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.apprvl.info"),[]))+"</div>":(A.banned)?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.banned_member.msg"),[]))+"</div>":"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.confirm"),[]))+"</div>");return C?"":B.toString()};jive.socialgroups.soy.leaveConfirmation=function(A,C){var B=C||new soy.StringBuilder();B.append((A.pendingApproval)?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.cancel.message"),[]))+"</div>":"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.message"),[]))+"</div>");return C?"":B.toString()};jive.socialgroups.soy.renderError=function(A,C){var B=C||new soy.StringBuilder();switch(A.code){case 4026:B.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.notallowed"),[])),"</p>");break;case 4008:B.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.not.found"),[])),"</p>");break;default:if(A.message){B.append("<p>",soy.$$escapeHtml(A.message),"</p>")}else{jive.error.rest.soy.errorFinding(A,B)}}return C?"":B.toString()}
;
jive.namespace("MembershipApp");jive.MembershipApp.MembershipView=jive.oo.Class.extend(function(a){var b="browse",d="landing";jive.conc.observable(this);this.init=function(g,i,f){var e=this;this.joinContainer=g;this.leaveContainer=i;this.options=f||{};var h="objectID" in f?d:b;this.isPage=function(j){return h===j};$j(document).ready(function(){if(e.isPage(d)){$j(document).delegate(e.joinContainer,"click",function(j){e.joinGroup($j(this));j.preventDefault()});$j(document).delegate(e.leaveContainer,"click",function(j){e.displayLeaveGroupModal($j(this));j.preventDefault()})}else{$j("body").on("click",".sgroup-join, .sgroup-leave",function(k){k.preventDefault();var j=$j(this);if(j.is(".sgroup-join")){e.joinGroup(j)}else{e.displayLeaveGroupModal(j)}})}})};this.joinGroup=function(f){var e=this;var g=e.determineObjectID(f);e.emitP("join",g).addCallback(function(h){var i=$j.noop;if(e.isPage(d)){if(!h.banned){$j(e.leaveContainer).show();$j(e.joinContainer).hide()}i=function(){if(h.memberToContribute){window.location=c(1)}}}else{$j(f).closest(".j-thumb-back, .j-td-follow-action").find("a.sgroup-leave").show();$j(f).hide()}e.displayMessage(jive.socialgroups.soy.joinConfirmation(h),i);$j("#jive-link-socialgroup-startFollowing").hide();$j("#jive-link-socialgroup-following").show()}).addErrback(function(i,h){console.log("got error message: "+i+" code: "+h);e.displayError(i,h)})};this.displayLeaveGroupModal=function(f){var e=this;var g=e.determineObjectID(f);e.emitP("prepareLeave",g).addCallback(function(j){var h=$j(jive.socialgroups.soy.leaveGroup(j));$j("body").append(h);var i=$j("body").find("#jive-modal-leave-group");i.lightbox_me({closeSelector:".jive-modal-close, .close",destroyOnClose:true});i.find("#group-leave-submit").click(function(){e.leaveGroup(f,j);i.trigger("close")})}).addErrback(function(i,h){e.displayError(i,h)})};this.leaveGroup=function(f,g){var e=this;var h=e.determineObjectID(f);e.emitP("leave",h).addCallback(function(){var i=$j.noop;if(e.isPage(d)){$j(e.joinContainer).show();$j(e.leaveContainer).hide();$j("#jive-link-socialgroup-following").hide();$j("#jive-link-socialgroup-startFollowing").show();i=function(){if(!g.visibleAfterLeaving){window.location=jive.app.url({path:"/groups"})}else{if(g.memberToContribute){window.location=c(-1)}}}}else{$j(f).closest(".j-thumb-back, .j-td-follow-action").find("a.sgroup-join").show();$j(f).hide()}e.displayMessage(jive.socialgroups.soy.leaveConfirmation(g),i)}).addErrback(function(j,i){e.displayError(j,i)})};this.displayMessage=function(e,f){$j("<p />").html(e).message({style:"success",dismissCallback:f||$j.noop})};this.displayError=function(g,f){var e=jive.socialgroups.soy.renderError({message:g,code:f,href:window.location.href});$j(e).message({style:"error",showClose:true})};this.determineObjectID=function(e){var f=this.options.objectID||e.attr("data-objectid")||0;return parseInt(f,10)};function c(e){return window.location.href.replace(/\?(.*&)?qstep=(\d+)/,function(h,f,i){var g=parseInt(i)+e;return"?"+f+"qstep="+g})}this.tearDown=function(){var e=this;if(e.isPage(d)){$j(e.joinContainer).off("click");$j(e.leaveContainer).off("click")}else{$j(".sgroup-join").off("click");$j(".sgroup-leave").off("click")}}});
;
jive.namespace("MembershipApp");jive.MembershipApp.MembershipSource=jive.RestService.extend(function(a){a.resourceType="socialgroup";this.save=function(d){var e=new jive.conc.Promise(),c=this;var b=$j.deparam.querystring().fromQ;$j.ajax({type:"POST",url:this.RESOURCE_ENDPOINT+"/"+d.objectID+"/members",dataType:"json",data:b,contentType:"application/json; charset=utf-8",success:function(f,h,g){e.emitSuccess(f)},error:function(h,j,i){try{var g=$j.parseJSON(h.responseText);if(g&&g.error&&g.error.message){e.emitError(g.error.message,g.error.code)}}catch(f){e.emitError(null,h&&h.status)}}});return e};this.get=function(d){var e=new jive.conc.Promise(),c=this;var b={};b[this.resourceType]=d;$j.ajax({type:"GET",url:this.RESOURCE_ENDPOINT+"/"+d.objectID+"/memberInfo",dataType:"json",data:JSON.stringify(b),contentType:"application/json; charset=utf-8",success:function(f,h,g){e.emitSuccess(f)},error:function(h,j,i){try{var g=$j.parseJSON(h.responseText);if(g&&g.error&&g.error.message){e.emitError(g.error.message,g.error.code)}}catch(f){e.emitError(null,h&&h.status)}}});return e};this.destroy=function(b){var c=new jive.conc.Promise();$j.ajax({type:"DELETE",url:this.RESOURCE_ENDPOINT+"/"+b.objectID+"/members",success:function(){c.emitSuccess()},error:function(d){c.emitError(null,d.status)}});return c}});
;
jive.namespace("MembershipApp");jive.MembershipApp.Main=jive.oo.Class.extend(function(a){this.init=function(c){var b=this;this.membershipSource=new jive.MembershipApp.MembershipSource(c);this.membershipView=new jive.MembershipApp.MembershipView("#jive-link-joinSocialGroup,.jive-link-joinSocialGroup","#jive-link-leaveSocialGroup,.jive-link-leaveSocialGroup",c);this.membershipView.addListener("join",function(e,d){b.membershipSource.save({objectID:e}).addCallback(function(f){d.emitSuccess(f);jive.switchboard.emit("sgroup.member.join",f)}).addErrback(function(g,f){console.log("got a err in main.js");d.emitError(g,f)})}).addListener("leave",function(e,d){b.membershipSource.destroy({objectID:e}).addCallback(function(){jive.switchboard.emit("sgroup.member.leave",e);d.emitSuccess()}).addErrback(function(g,f){console.log("got a err in main.js");d.emitError(g,f)})}).addListener("prepareLeave",function(e,d){b.membershipSource.get({objectID:e}).addCallback(function(f){d.emitSuccess(f)}).addErrback(function(g,f){console.log("got a err in main.js");d.emitError(g,f)})})};this.tearDown=function(){this.membershipView.removeListener("join").removeListener("leave").removeListener("prepareLeave").tearDown()}});define("jive.membershipApp.Main",function(){return jive.MembershipApp.Main});
;
if(typeof jive=="undefined"){var jive={}}if(typeof jive.soy=="undefined"){jive.soy={}}if(typeof jive.soy.email_notification=="undefined"){jive.soy.email_notification={}}jive.soy.email_notification.start=function(A,C){var B=C||new soy.StringBuilder();switch(A.type){case"common":jive.soy.email_notification.common({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.start_watch.link"),[]))},B);break;case"socialButton":jive.soy.email_notification.commonInSocialButton({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.start_watch.link"),[]))},B);break}return C?"":B.toString()};jive.soy.email_notification.stop=function(A,C){var B=C||new soy.StringBuilder();switch(A.type){case"common":jive.soy.email_notification.common({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.stop_watch.link"),[]))},B);break;case"socialButton":jive.soy.email_notification.commonInSocialButton({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.stop_watch.link"),[]))},B);break}return C?"":B.toString()};jive.soy.email_notification.message=function(A,C){var B=C||new soy.StringBuilder();switch(A.type){case"watch":B.append((A.isUser)?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watchuser.start"),[]))+"</p>":"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watch.start"),[]))+"</p>");break;case"unwatch":B.append((A.isUser)?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watchuser.stop"),[]))+"</p>":"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watch.stop"),[]))+"</p>");break}return C?"":B.toString()};jive.soy.email_notification.common=function(A,C){var B=C||new soy.StringBuilder();B.append('<a href="#" rel="nofollow"><span class="jive-icon-med jive-icon-message-open"></span>',soy.$$escapeHtml(A.message),"</a>");return C?"":B.toString()};jive.soy.email_notification.commonInSocialButton=function(A,C){var B=C||new soy.StringBuilder();B.append('<a href="#" class="j-social-button j-rc5 j-button-toggle-email-notifications j-ui-elem"><span class="j-ui-elem"><span class="jive-icon-med jive-icon-message-open"></span>',soy.$$escapeHtml(A.message),"</span></a>");return C?"":B.toString()}
;
jive.namespace("EmailNotification");jive.EmailNotification.Source=jive.RestService.extend(function(a){a.resourceType="emailwatches";a.pluralizedResourceType=a.resourceType;a.resourceType="emailwatches";this.watch=function(d,b){var c=this.RESOURCE_ENDPOINT+"/watch/"+b+"/"+d;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:c})};this.unwatch=function(d,b){var c=this.RESOURCE_ENDPOINT+"/unwatch/"+b+"/"+d;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:c})}});
;
jive.namespace("EmailNotification");jive.EmailNotification.Main=function(e,d,b){var a=new jive.EmailNotification.Source(),c={watch:{newId:"jive-link-thread-unwatch",save:a.watch.bind(a),view:jive.soy.email_notification.stop},unwatch:{newId:"jive-link-thread-watch",save:a.unwatch.bind(a),view:jive.soy.email_notification.start}};$j("#jive-link-thread-watch, #jive-link-thread-unwatch").delegate("a","click",function(g){g.preventDefault();var h=$j(this).closest("#jive-link-thread-watch, #jive-link-thread-unwatch"),f=h.attr("id").split("-").pop();c[f].save(e,d).addCallback(function(){h.attr("id",c[f].newId).html(c[f].view({type:h.attr("data-type")||"common"}));$j(jive.soy.email_notification.message({type:f,isUser:!!b})).message({style:"success"})})})};
;
jive.NestedRestService=jive.RestService.extend(function(a,b){a.init=function(c){b.init.call(this,c);this.parentType=c.parentType;this.parentID=c.parentID;this.POST_RESOURCE_ENDPOINT=[this.RESOURCE_ENDPOINT,this.parentType,this.parentID].join("/")}});
;
jive.namespace("Browse.Content");jive.Browse.Content.ItemSource=jive.RestService.extend(function(a){a.resourceType="content";a.pluralizedResourceType=a.resourceType;a.putOnUpdate=true});
;
jive.namespace("Browse.Container");jive.Browse.Container.ItemSource=jive.RestService.extend(function(a){a.resourceType="container";this.getContainerProperty=function(c){var b=this.RESOURCE_ENDPOINT+"/"+c.containerType+"/"+c.containerID+"/prop/"+c.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:b,data:{}})};this.setContainerProperty=function(c){var b=this.RESOURCE_ENDPOINT+"/"+c.containerType+"/"+c.containerID+"/prop/"+c.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:b,data:c.propValue})};this.removeContainerProperty=function(c){var b=this.RESOURCE_ENDPOINT+"/"+c.containerType+"/"+c.containerID+"/prop/"+c.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"DELETE",{url:b})};this.getSpaceChildren=function(c){var b=this.RESOURCE_ENDPOINT+"/"+c.containerID+"/children";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:b,data:c})};this.getBreadcrumbBean=function(c){var b=this.RESOURCE_ENDPOINT+"/"+c.containerType+"/"+c.containerID+"/breadcrumbs";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:b,data:{}})}});
;
if(typeof jive=="undefined"){var jive={}}if(typeof jive.movecontent=="undefined"){jive.movecontent={}}jive.movecontent.imports=function(A,C){var B=C||new soy.StringBuilder();return C?"":B.toString()};jive.movecontent.successMessage=function(A,E){var C=E||new soy.StringBuilder();C.append('<div class="jive-success-box" aria-live="polite" aria-atomic="true"><div><span class="jive-icon-med jive-icon-check"></span>');var B=new soy.StringBuilder();jive.shared.displayutil.containerDisplayNameLink({container:A.prevContainer},B);var D=new soy.StringBuilder();jive.shared.displayutil.containerDisplayNameLink(A,D);jive.shared.soy.i18nHelper({i18nKey:"content.mv.success",arg0:soy.$$escapeHtml(A.contentTypeName),arg1:B.toString(),arg2:D.toString(),noAutoEscape:"true"},C);C.append("</div></div>");return E?"":C.toString()};jive.movecontent.confirm=function(A,C){var B=C||new soy.StringBuilder();B.append('<div class="js-move-confirm-section"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.confirm.title"),[])),'</h2></header><a class="j-modal-close-top close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),' <span class="j-close-icon j-ui-elem" role="img"></span></a><section class="jive-modal-content jive-modal-content-move clearfix"><h6>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.really_move_it.text"),[A.content.objectTypeName])),'</h6><p><img src="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/6.0.3.73caaf5/","","/images/transparent.png")),'" alt="" class="',soy.$$escapeHtml(A.content.iconCss),' jive-icon-med" /> ',A.content.subject,"</p><h6>");if(A.targetPersonalContainer){jive.shared.soy.i18nHelper({i18nKey:"content.mv.into_ctr.text",arg0:'<img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/6.0.3.73caaf5/","","/images/transparent.png"))+'" alt="" class="'+soy.$$escapeHtml(A.content.iconCss)+' jive-icon-med" /> '+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(A.personalContainerKey),[])),noAutoEscape:"true"},B)}else{B.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.into_this_ctr.text"),[A.targetContainer.objectTypeName])))}B.append("</h6>",(!A.targetPersonalContainer)?'<p><img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/6.0.3.73caaf5/","","/images/transparent.png"))+'" alt="" class="'+soy.$$escapeHtml(A.targetContainer.iconCss)+' jive-icon-med" /> '+A.targetContainer.subject+"</p>":"",(A.docWithCollaborators)?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.remove_collab.text"),[]))+"</span></p>":"",(A.restrictedSocialGroup)?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.restricted_group.text"),[]))+"</span></p>":"",'<div class="j-form-row"><button class="js-move-confirm j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.confirm.button"),[])),'</button><button class="js-move-confirm-cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></section></div>");return C?"":B.toString()}
;
jive.namespace("Move.Content");jive.Move.Content.MoveView=jive.AbstractView.extend(function(a){var c=jQuery,b=jive.Move.Content;a.init=function(){var d=this;c(document).ready(function(){c("#jive-link-move a, a#jive-link-move").click(function(e){d.emit("browse");e.preventDefault()})})};this.confirm=function(f){var d=this;var e=c(".jive-modal");var g=jive.movecontent.confirm(f);d.prevContent=e.children();d.visibleContent=d.prevContent.filter(":visible");d.visibleContent.hide();e.append(g).removeClass("j-container-browse").trigger("resize");e.find(".js-move-confirm").click(function(h){d.emit("moveConfirmed",{targetContainerType:f.targetContainer.type,targetContainerID:f.targetContainer.id});h.preventDefault()});e.find(".js-move-confirm-cancel").click(function(h){e.find(".js-move-confirm-section").remove();d.visibleContent.show();e.addClass("j-container-browse").trigger("resize");h.preventDefault()});e.find(".close").click(function(h){e.find(".js-move-confirm-section").remove();h.preventDefault()});c("body").find(".js_lb_overlay").click(function(h){e.find(".js-move-confirm-section").remove();h.preventDefault()})}});
;
jive.namespace("Move.Content");jive.Move.Content.CapabilitiesSource=jive.NestedRestService.extend(function(a,b){a.resourceType="capability";a.init=function(c){b.init.call(this,c);this.pluralizedResourceType="capabilities";this.RESOURCE_ENDPOINT=jive.rest.url("/"+["content",this.parentType,this.parentID,this.pluralizedResourceType].join("/"));this.POST_RESOURCE_ENDPOINT=this.RESOURCE_ENDPOINT}});
;
jive.namespace("Move.Container");jive.Move.Container.CapabilitiesSource=jive.NestedRestService.extend(function(a,b){a.resourceType="capability";a.init=function(c){b.init.call(this,c);this.pluralizedResourceType="capabilities";this.RESOURCE_ENDPOINT=jive.rest.url("/"+["containers",this.parentType,this.parentID,this.pluralizedResourceType].join("/"));this.POST_RESOURCE_ENDPOINT=this.RESOURCE_ENDPOINT}});
;
jive.namespace("Move.Content");jive.Move.Content.Main=jive.oo.Class.extend(function(a){a.init=function(c){var b=this;this.objectType=c.objectType;this.objectID=c.objectID;this.containerType=c.containerType;this.containerID=c.containerID;this.isContainer=c.isContainer||false;this.contentCapabilitiesSource=new jive.Move.Content.CapabilitiesSource({parentID:this.objectID,parentType:this.objectType});this.containerCapabilitiesSource=new jive.Move.Container.CapabilitiesSource({parentID:this.objectID,parentType:this.objectType});this.contentSource=new jive.Browse.Content.ItemSource();this.containerSource=new jive.Browse.Container.ItemSource();this.moveView=new jive.Move.Content.MoveView();this.placePicker=new jive.Placepicker.Main($j.extend({pickerContext:"move"},c));this.moveView.addListener("browse",function(d){b.placePicker.showPicker()});this.moveView.addListener("moveConfirmed",function(d){if(b.isContainer){b.handleConfirmation(b.containerSource,d)}else{b.handleConfirmation(b.contentSource,d)}});this.placePicker.addListener("container",function(d,e){if(b.isContainer){b.handleContainerSelected(b.containerCapabilitiesSource,d)}else{b.handleContainerSelected(b.contentCapabilitiesSource,d)}})};a.handleConfirmation=function(d,c){var b=this;d.save({id:b.objectType+"/"+b.objectID,objectType:c.targetContainerType,objectID:c.targetContainerID}).addCallback(function(e){window.location=jive.app.url({path:e.link+"?prevContainerType="+b.containerType+"&prevContainerID="+b.containerID})})};a.handleContainerSelected=function(d,c){var b=this;d.findAll({containerType:c.targetContainerType,containerID:c.targetContainerID}).addCallback(function(e){b.moveView.confirm(e)})}});
;
jive.namespace("Modalizer");jive.Modalizer.ModalView=jive.AbstractView.extend(function(a){var c=jQuery,b=jive.Modalizer;a.init=function(h){var e=this,f,g={};if(h.width&&h.width.match(/^(narrow|medium|wide)$/i)){f="jive-modal-"+h.width}else{if(h.width){g.width=h.width}else{f="jive-modal-medium"}}var d=function(j){var i=c(this).attr("href")||c(this).find("a:first").attr("href");if(i){e.emitP("launch",i).addCallback(function(p){var o=c("<div/>",{"class":"jive-modal j-modal"+(f?" "+f:""),id:"js-modalized"}).css(g);var n=e.separateScripts(p);var m=e.shiv(n[0]);var k=n[1];var l=!c.browser.msie||parseInt(c.browser.version,10)>8;l&&o.html(m);o.lightbox_me({destroyOnClose:true,closeFocusSelector:h.triggers?h.triggers.join(", "):h.liveTriggers.join(", "),onClose:h.onClose,onLoad:function(){if(!l){o.html(m);k()}}});if(l){k()}})}else{alert("No valid URL found to modalize")}j.preventDefault()};c(document).ready(function(){if(h.triggers){c.each(h.triggers,function(){c(""+this).click(d)})}if(h.liveTriggers){c.each(h.liveTriggers,function(){c(""+this).live("click",d)})}})}});
;
jive.namespace("Modalizer");jive.Modalizer.ModalSource=jive.oo.Class.extend(function(a){this.getConfirmation=function(b,c){$j.ajax({url:b,type:"GET",dataType:"html",success:function(d){c(d)},error:function(){alert("failed..")}})}});
;
jive.namespace("Modalizer");jive.Modalizer.Main=jive.oo.Class.extend(function(a){a.init=function(c){var b=this;this.modalView=new jive.Modalizer.ModalView(c);this.modalSource=jive.Modalizer.ModalSource();this.modalView.addListener("launch",function(d,e){b.modalSource.getConfirmation(d,function(f){e.emitSuccess(f)})})}});
;
if(typeof jive=="undefined"){var jive={}}if(typeof jive.modalizer=="undefined"){jive.modalizer={}}jive.modalizer.foo=function(A,C){var B=C||new soy.StringBuilder();return C?"":B.toString()}
;
