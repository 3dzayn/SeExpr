<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SeExpr: /disk1/scratch/aselle/projects/seexpr/SeExpr/src/SeExprEditor/SeExprEdBrowser.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>/disk1/scratch/aselle/projects/seexpr/SeExpr/src/SeExprEditor/SeExprEdBrowser.cpp</h1><a href="SeExprEdBrowser_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">* (c) Disney Enterprises, Inc.  All rights reserved.</span>
<a name="l00003"></a>00003 <span class="comment">*</span>
<a name="l00004"></a>00004 <span class="comment">* This file is licensed under the terms of the Microsoft Public License (MS-PL)</span>
<a name="l00005"></a>00005 <span class="comment">* as defined at: http://opensource.org/licenses/MS-PL.</span>
<a name="l00006"></a>00006 <span class="comment">*</span>
<a name="l00007"></a>00007 <span class="comment">* A complete copy of this license is included in this distribution as the file</span>
<a name="l00008"></a>00008 <span class="comment">* LICENSE.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* @file SeExprEdExpression.h</span>
<a name="l00011"></a>00011 <span class="comment">* @brief A basic expression context for the expression previewer</span>
<a name="l00012"></a>00012 <span class="comment">* @author  aselle</span>
<a name="l00013"></a>00013 <span class="comment">*/</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;QtGui/QTreeWidget&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;QtGui/QTreeWidgetItem&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;QtGui/QVBoxLayout&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;QtGui/QTabWidget&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;QtGui/QHeaderView&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;QtGui/QLabel&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;QtGui/QTextBrowser&gt;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;QtGui/QPushButton&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;QtGui/QSpacerItem&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;QtGui/QSizePolicy&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;QtGui/QSortFilterProxyModel&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;QtCore/QDir&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;QtCore/QFileInfo&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;QtGui/QFileDialog&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;QtGui/QMessageBox&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="SeExprEditor_8h.html">SeExprEditor.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="SeExprEdBrowser_8h.html">SeExprEdBrowser.h</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="SeExprEdBrowser_8cpp.html#a49be0f378c0e7f4e64387e0d186e6ebc">00033</a> <span class="preprocessor">#define P3D_CONFIG_ENVVAR &quot;P3D_CONFIG_PATH&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="classSeExprEdTreeItem.html">00036</a> <span class="keyword">class </span><a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038 <span class="keyword">public</span>:
<a name="l00039"></a><a class="code" href="classSeExprEdTreeItem.html#abc6f1a6e217e6a9ead480545e6ebc4f2">00039</a>     <a class="code" href="classSeExprEdTreeItem.html#abc6f1a6e217e6a9ead480545e6ebc4f2">SeExprEdTreeItem</a>(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* <a class="code" href="classSeExprEdTreeItem.html#ab542141d2ced0a5fb2fc0cd8efa20d7e">parent</a>,<span class="keyword">const</span> QString&amp; <a class="code" href="classSeExprEdTreeItem.html#acc26fea250fecf7bced0deec89c65bb4">label</a>,<span class="keyword">const</span> QString&amp; <a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>)
<a name="l00040"></a>00040         :<a class="code" href="classSeExprEdTreeItem.html#a6fe93ee635df27331b58c69c4bd22f26">row</a>(-1),parent(parent),label(label),path(path),<a class="code" href="classSeExprEdTreeItem.html#abf6e9368ae391694b5609da91725fdcc">populated</a>(parent==0)
<a name="l00041"></a>00041     {}
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="classSeExprEdTreeItem.html#acf1cd14f1be6561c10eaae0d53ec717c">00043</a>     <a class="code" href="classSeExprEdTreeItem.html#acf1cd14f1be6561c10eaae0d53ec717c">~SeExprEdTreeItem</a>()
<a name="l00044"></a>00044     {
<a name="l00045"></a>00045         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.size();i++)
<a name="l00046"></a>00046             <span class="keyword">delete</span> <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>[i];
<a name="l00047"></a>00047     }
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="classSeExprEdTreeItem.html#a471ed571f0d413c5cd7a883490b02a94">00049</a>     <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* <a class="code" href="classSeExprEdTreeItem.html#a471ed571f0d413c5cd7a883490b02a94">find</a>(QString <a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>)
<a name="l00050"></a>00050     {
<a name="l00051"></a>00051         <span class="keywordflow">if</span>(this-&gt;path==path) <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00052"></a>00052         <span class="keywordflow">else</span>{
<a name="l00053"></a>00053             <a class="code" href="classSeExprEdTreeItem.html#a88d5a5173310567a9e7a674a27009619">populate</a>();
<a name="l00054"></a>00054             <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.size();i++){
<a name="l00055"></a>00055                 <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* ret=<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>[i]-&gt;find(path);
<a name="l00056"></a>00056                 <span class="keywordflow">if</span>(ret) <span class="keywordflow">return</span> ret;
<a name="l00057"></a>00057             }
<a name="l00058"></a>00058         }
<a name="l00059"></a>00059         <span class="keywordflow">return</span> 0;
<a name="l00060"></a>00060     }
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="classSeExprEdTreeItem.html#a753312d91cb26fbde5709b4d32a439bb">00062</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeItem.html#a753312d91cb26fbde5709b4d32a439bb">clear</a>()
<a name="l00063"></a>00063     {
<a name="l00064"></a>00064         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.size();i++) {
<a name="l00065"></a>00065             <span class="keyword">delete</span> <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>[i];
<a name="l00066"></a>00066         }
<a name="l00067"></a>00067         <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.clear();
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="classSeExprEdTreeItem.html#a88d5a5173310567a9e7a674a27009619">00070</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeItem.html#a88d5a5173310567a9e7a674a27009619">populate</a>()
<a name="l00071"></a>00071     {
<a name="l00072"></a>00072         <span class="keywordflow">if</span>(<a class="code" href="classSeExprEdTreeItem.html#abf6e9368ae391694b5609da91725fdcc">populated</a>) <span class="keywordflow">return</span>;
<a name="l00073"></a>00073         <a class="code" href="classSeExprEdTreeItem.html#abf6e9368ae391694b5609da91725fdcc">populated</a>=<span class="keyword">true</span>;
<a name="l00074"></a>00074         QFileInfo info(<a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>);
<a name="l00075"></a>00075         <span class="keywordflow">if</span>(info.isDir()){
<a name="l00076"></a>00076             QFileInfoList infos=QDir(<a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>).entryInfoList(QDir::Dirs | QDir::Files | QDir::NoDotAndDotDot);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078             <span class="comment">//std::cerr&lt;&lt;&quot;is dir and populating &quot;&lt;&lt;path.toStdString()&lt;&lt;std::endl;</span>
<a name="l00079"></a>00079             <span class="keywordflow">for</span>(QList&lt;QFileInfo&gt;::ConstIterator it=infos.constBegin();it!=infos.constEnd();++it){
<a name="l00080"></a>00080                 <span class="keyword">const</span> QFileInfo* fi=&amp;*it;
<a name="l00081"></a>00081                 <span class="keywordflow">if</span>(fi-&gt;isDir() || fi-&gt;fileName().endsWith(<span class="stringliteral">&quot;.se&quot;</span>)){
<a name="l00082"></a>00082                     <a class="code" href="classSeExprEdTreeItem.html#a7181160d6b8c50681b55d03db59de31f">addChild</a>(<span class="keyword">new</span> <a class="code" href="classSeExprEdTreeItem.html#abc6f1a6e217e6a9ead480545e6ebc4f2">SeExprEdTreeItem</a>(<span class="keyword">this</span>,fi-&gt;fileName(),fi-&gt;filePath()));
<a name="l00083"></a>00083                 }
<a name="l00084"></a>00084             }
<a name="l00085"></a>00085         }
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="classSeExprEdTreeItem.html#a7181160d6b8c50681b55d03db59de31f">00088</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeItem.html#a7181160d6b8c50681b55d03db59de31f">addChild</a>(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* child)
<a name="l00089"></a>00089     {
<a name="l00090"></a>00090         child-&gt;<a class="code" href="classSeExprEdTreeItem.html#a6fe93ee635df27331b58c69c4bd22f26">row</a>=<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.size();
<a name="l00091"></a>00091         <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.push_back(child);
<a name="l00092"></a>00092     }
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="classSeExprEdTreeItem.html#a9973117a781315b6fac6d40af952df09">00094</a>     <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* <a class="code" href="classSeExprEdTreeItem.html#a9973117a781315b6fac6d40af952df09">getChild</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classSeExprEdTreeItem.html#a6fe93ee635df27331b58c69c4bd22f26">row</a>)
<a name="l00095"></a>00095     {
<a name="l00096"></a>00096         <a class="code" href="classSeExprEdTreeItem.html#a88d5a5173310567a9e7a674a27009619">populate</a>();
<a name="l00097"></a>00097         <span class="keywordflow">if</span>(row&lt;0 || row&gt;(<span class="keywordtype">int</span>)<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.size()){
<a name="l00098"></a>00098             assert(<span class="keyword">false</span>);
<a name="l00099"></a>00099         }
<a name="l00100"></a>00100         <span class="keywordflow">return</span> <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>[row];
<a name="l00101"></a>00101     }
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="classSeExprEdTreeItem.html#ac78fe19e445a9dceed278c43d8196c53">00103</a>     <span class="keywordtype">int</span> <a class="code" href="classSeExprEdTreeItem.html#ac78fe19e445a9dceed278c43d8196c53">getChildCount</a>()
<a name="l00104"></a>00104     {
<a name="l00105"></a>00105         <a class="code" href="classSeExprEdTreeItem.html#a88d5a5173310567a9e7a674a27009619">populate</a>();
<a name="l00106"></a>00106         <span class="keywordflow">return</span> <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.size();
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="classSeExprEdTreeItem.html#ab3f18c96b3ff6d3e4475943260664084">00109</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeItem.html#ab3f18c96b3ff6d3e4475943260664084">regen</a>()
<a name="l00110"></a>00110     {
<a name="l00111"></a>00111         std::vector&lt;QString&gt; labels,paths;
<a name="l00112"></a>00112         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.size();i++){
<a name="l00113"></a>00113             labels.push_back(<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>[i]-&gt;<a class="code" href="classSeExprEdTreeItem.html#acc26fea250fecf7bced0deec89c65bb4">label</a>);
<a name="l00114"></a>00114             paths.push_back(<a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>[i]-&gt;<a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>);
<a name="l00115"></a>00115             <span class="keyword">delete</span> <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>[i];
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117         <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>.clear();
<a name="l00118"></a>00118 
<a name="l00119"></a>00119         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;labels.size();i++)
<a name="l00120"></a>00120             <a class="code" href="classSeExprEdTreeItem.html#a7181160d6b8c50681b55d03db59de31f">addChild</a>(<span class="keyword">new</span> <a class="code" href="classSeExprEdTreeItem.html#abc6f1a6e217e6a9ead480545e6ebc4f2">SeExprEdTreeItem</a>(<span class="keyword">this</span>,labels[i],paths[i]));
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="classSeExprEdTreeItem.html#a6fe93ee635df27331b58c69c4bd22f26">00124</a>     <span class="keywordtype">int</span> <a class="code" href="classSeExprEdTreeItem.html#a6fe93ee635df27331b58c69c4bd22f26">row</a>;
<a name="l00125"></a><a class="code" href="classSeExprEdTreeItem.html#ab542141d2ced0a5fb2fc0cd8efa20d7e">00125</a>     <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* <a class="code" href="classSeExprEdTreeItem.html#ab542141d2ced0a5fb2fc0cd8efa20d7e">parent</a>;
<a name="l00126"></a><a class="code" href="classSeExprEdTreeItem.html#acc26fea250fecf7bced0deec89c65bb4">00126</a>     QString <a class="code" href="classSeExprEdTreeItem.html#acc26fea250fecf7bced0deec89c65bb4">label</a>;
<a name="l00127"></a><a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">00127</a>     QString <a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>;
<a name="l00128"></a>00128 <span class="keyword">private</span>:
<a name="l00129"></a><a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">00129</a>     std::vector&lt;SeExprEdTreeItem*&gt; <a class="code" href="classSeExprEdTreeItem.html#a73203272bf328104e53203c43885d56e">children</a>;
<a name="l00130"></a><a class="code" href="classSeExprEdTreeItem.html#abf6e9368ae391694b5609da91725fdcc">00130</a>     <span class="keywordtype">bool</span> <a class="code" href="classSeExprEdTreeItem.html#abf6e9368ae391694b5609da91725fdcc">populated</a>;
<a name="l00131"></a>00131 };
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="classSeExprEdTreeModel.html">00133</a> <span class="keyword">class </span><a class="code" href="classSeExprEdTreeModel.html">SeExprEdTreeModel</a>:<span class="keyword">public</span> QAbstractItemModel
<a name="l00134"></a>00134 {
<a name="l00135"></a><a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">00135</a>     <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* <a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>;
<a name="l00136"></a>00136 <span class="keyword">public</span>:
<a name="l00137"></a><a class="code" href="classSeExprEdTreeModel.html#a077f9efddf481a9124e41e1fd02af2ca">00137</a>     <a class="code" href="classSeExprEdTreeModel.html#a077f9efddf481a9124e41e1fd02af2ca">SeExprEdTreeModel</a>()
<a name="l00138"></a>00138         :<a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>(new <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>(0,<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>))
<a name="l00139"></a>00139     {}
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="classSeExprEdTreeModel.html#a8c2938d1f22ee3c1272c50a8a94c91f1">00141</a>     <a class="code" href="classSeExprEdTreeModel.html#a8c2938d1f22ee3c1272c50a8a94c91f1">~SeExprEdTreeModel</a>()
<a name="l00142"></a>00142     {
<a name="l00143"></a>00143         <span class="keyword">delete</span> <a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>;
<a name="l00144"></a>00144     }
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="classSeExprEdTreeModel.html#aa9f33254c9f4b3ee5bf2ea9d07950aa4">00146</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeModel.html#aa9f33254c9f4b3ee5bf2ea9d07950aa4">update</a>()
<a name="l00147"></a>00147     {
<a name="l00148"></a>00148         reset();
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="classSeExprEdTreeModel.html#a31cca44fa0b5846f96abcfb5f9295a6f">00151</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeModel.html#a31cca44fa0b5846f96abcfb5f9295a6f">clear</a>()
<a name="l00152"></a>00152     {
<a name="l00153"></a>00153         <a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#a753312d91cb26fbde5709b4d32a439bb">clear</a>();
<a name="l00154"></a>00154         <a class="code" href="classSeExprEdTreeModel.html#aa9f33254c9f4b3ee5bf2ea9d07950aa4">update</a>();
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="classSeExprEdTreeModel.html#a609ed8580afe42806218e3178dd5e879">00157</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeModel.html#a609ed8580afe42806218e3178dd5e879">addPath</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* label,<span class="keyword">const</span> <span class="keywordtype">char</span>* path)
<a name="l00158"></a>00158     {
<a name="l00159"></a>00159         <a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#a7181160d6b8c50681b55d03db59de31f">addChild</a>(<span class="keyword">new</span> <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>(<a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>,label,path));
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">00162</a>     QModelIndex <a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>(<span class="keyword">const</span> QModelIndex&amp; <a class="code" href="classSeExprEdTreeModel.html#a80da67a7a33d17e9701c89a1723ed3f3">index</a>)<span class="keyword"> const</span>
<a name="l00163"></a>00163 <span class="keyword">    </span>{
<a name="l00164"></a>00164         <span class="keywordflow">if</span>(!index.isValid()) <span class="keywordflow">return</span> QModelIndex();
<a name="l00165"></a>00165         <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* item=(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>*)(index.internalPointer());
<a name="l00166"></a>00166         <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* parentItem=item-&gt;<a class="code" href="classSeExprEdTreeItem.html#ab542141d2ced0a5fb2fc0cd8efa20d7e">parent</a>;
<a name="l00167"></a>00167         <span class="keywordflow">if</span>(parentItem==<a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>) <span class="keywordflow">return</span> QModelIndex();
<a name="l00168"></a>00168         <span class="keywordflow">else</span> <span class="keywordflow">return</span> createIndex(parentItem-&gt;<a class="code" href="classSeExprEdTreeItem.html#a6fe93ee635df27331b58c69c4bd22f26">row</a>,0,parentItem);
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170 
<a name="l00171"></a><a class="code" href="classSeExprEdTreeModel.html#a80da67a7a33d17e9701c89a1723ed3f3">00171</a>     QModelIndex <a class="code" href="classSeExprEdTreeModel.html#a80da67a7a33d17e9701c89a1723ed3f3">index</a>(<span class="keywordtype">int</span> row,<span class="keywordtype">int</span> column,<span class="keyword">const</span> QModelIndex&amp; <a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>=QModelIndex())<span class="keyword"> const</span>
<a name="l00172"></a>00172 <span class="keyword">    </span>{
<a name="l00173"></a>00173         <span class="keywordflow">if</span>(!hasIndex(row,column,<a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>))
<a name="l00174"></a>00174             <span class="keywordflow">return</span> QModelIndex();
<a name="l00175"></a>00175         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>.isValid()) <span class="keywordflow">return</span> createIndex(row,column,<a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#a9973117a781315b6fac6d40af952df09">getChild</a>(row));
<a name="l00176"></a>00176         <span class="keywordflow">else</span>{
<a name="l00177"></a>00177             <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* item=(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>*)(<a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>.internalPointer());
<a name="l00178"></a>00178             <span class="keywordflow">return</span> createIndex(row,column,item-&gt;<a class="code" href="classSeExprEdTreeItem.html#a9973117a781315b6fac6d40af952df09">getChild</a>(row));
<a name="l00179"></a>00179         }
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181 
<a name="l00182"></a><a class="code" href="classSeExprEdTreeModel.html#a26a1aaf6e7812993f1455a241a82a7e4">00182</a>     <span class="keywordtype">int</span> <a class="code" href="classSeExprEdTreeModel.html#a26a1aaf6e7812993f1455a241a82a7e4">columnCount</a>(<span class="keyword">const</span> QModelIndex&amp; <a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>)<span class="keyword"> const</span>
<a name="l00183"></a>00183 <span class="keyword">    </span>{Q_UNUSED(parent); <span class="keywordflow">return</span> 1;}
<a name="l00184"></a>00184 
<a name="l00185"></a><a class="code" href="classSeExprEdTreeModel.html#afa410f06128170ebd858052bf43592f0">00185</a>     <span class="keywordtype">int</span> <a class="code" href="classSeExprEdTreeModel.html#afa410f06128170ebd858052bf43592f0">rowCount</a>(<span class="keyword">const</span> QModelIndex&amp; <a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>=QModelIndex())<span class="keyword"> const</span>
<a name="l00186"></a>00186 <span class="keyword">    </span>{
<a name="l00187"></a>00187         <span class="keywordflow">if</span>(!<a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>.isValid()) <span class="keywordflow">return</span> <a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#ac78fe19e445a9dceed278c43d8196c53">getChildCount</a>();
<a name="l00188"></a>00188         <span class="keywordflow">else</span>{
<a name="l00189"></a>00189             <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* item=(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>*)(<a class="code" href="classSeExprEdTreeModel.html#af8ce61d8f9561dc2a9e03f09fdfcf12a">parent</a>.internalPointer());
<a name="l00190"></a>00190             <span class="keywordflow">if</span>(!item) <span class="keywordflow">return</span> <a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#ac78fe19e445a9dceed278c43d8196c53">getChildCount</a>();
<a name="l00191"></a>00191             <span class="keywordflow">else</span> <span class="keywordflow">return</span> item-&gt;<a class="code" href="classSeExprEdTreeItem.html#ac78fe19e445a9dceed278c43d8196c53">getChildCount</a>();
<a name="l00192"></a>00192         }
<a name="l00193"></a>00193     }
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="classSeExprEdTreeModel.html#a530134874fea3eb35398372530912ab9">00195</a>     QVariant <a class="code" href="classSeExprEdTreeModel.html#a530134874fea3eb35398372530912ab9">data</a>(<span class="keyword">const</span> QModelIndex&amp; <a class="code" href="classSeExprEdTreeModel.html#a80da67a7a33d17e9701c89a1723ed3f3">index</a>,<span class="keywordtype">int</span> role=Qt::DisplayRole)<span class="keyword"> const</span>
<a name="l00196"></a>00196 <span class="keyword">    </span>{
<a name="l00197"></a>00197         <span class="keywordflow">if</span>(!index.isValid()) <span class="keywordflow">return</span> QVariant();
<a name="l00198"></a>00198         <span class="keywordflow">if</span>(role!=Qt::DisplayRole) <span class="keywordflow">return</span> QVariant();
<a name="l00199"></a>00199         <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* item=(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>*)(index.internalPointer());
<a name="l00200"></a>00200         <span class="keywordflow">if</span>(!item) <span class="keywordflow">return</span> QVariant();
<a name="l00201"></a>00201         <span class="keywordflow">else</span> <span class="keywordflow">return</span> QVariant(item-&gt;<a class="code" href="classSeExprEdTreeItem.html#acc26fea250fecf7bced0deec89c65bb4">label</a>);
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="classSeExprEdTreeModel.html#a15985455ffde2e3ada61136992bacd08">00204</a>     QModelIndex <a class="code" href="classSeExprEdTreeModel.html#a15985455ffde2e3ada61136992bacd08">find</a>(QString path)
<a name="l00205"></a>00205     {
<a name="l00206"></a>00206         <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* item=<a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#a471ed571f0d413c5cd7a883490b02a94">find</a>(path);
<a name="l00207"></a>00207         <span class="keywordflow">if</span>(!item) {
<a name="l00208"></a>00208             <a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#ab3f18c96b3ff6d3e4475943260664084">regen</a>();
<a name="l00209"></a>00209             reset();
<a name="l00210"></a>00210             item=<a class="code" href="classSeExprEdTreeModel.html#a2c03500c68ba9b2cebe33d7016b333f5">root</a>-&gt;<a class="code" href="classSeExprEdTreeItem.html#a471ed571f0d413c5cd7a883490b02a94">find</a>(path);
<a name="l00211"></a>00211         }
<a name="l00212"></a>00212         <span class="keywordflow">if</span>(item){
<a name="l00213"></a>00213             std::cerr&lt;&lt;<span class="stringliteral">&quot;found it &quot;</span>&lt;&lt;std::endl;
<a name="l00214"></a>00214             <span class="keywordflow">return</span> createIndex(item-&gt;<a class="code" href="classSeExprEdTreeItem.html#a6fe93ee635df27331b58c69c4bd22f26">row</a>,0,item);
<a name="l00215"></a>00215         }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         <span class="keywordflow">return</span> QModelIndex();
<a name="l00218"></a>00218     }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 };
<a name="l00221"></a>00221 
<a name="l00222"></a><a class="code" href="classSeExprEdTreeFilterModel.html">00222</a> <span class="keyword">class </span><a class="code" href="classSeExprEdTreeFilterModel.html">SeExprEdTreeFilterModel</a>:<span class="keyword">public</span> QSortFilterProxyModel
<a name="l00223"></a>00223 {
<a name="l00224"></a>00224 <span class="keyword">public</span>:
<a name="l00225"></a><a class="code" href="classSeExprEdTreeFilterModel.html#a11bf78d7e8048f4ad0eeb3f59c77a8ba">00225</a>     <a class="code" href="classSeExprEdTreeFilterModel.html#a11bf78d7e8048f4ad0eeb3f59c77a8ba">SeExprEdTreeFilterModel</a>(QWidget* parent=0)
<a name="l00226"></a>00226         :QSortFilterProxyModel(parent)
<a name="l00227"></a>00227     {}
<a name="l00228"></a>00228 
<a name="l00229"></a><a class="code" href="classSeExprEdTreeFilterModel.html#a1317a5eb96523a787d4cbfddf00b786d">00229</a>     <span class="keywordtype">void</span> <a class="code" href="classSeExprEdTreeFilterModel.html#a1317a5eb96523a787d4cbfddf00b786d">update</a>()
<a name="l00230"></a>00230     {
<a name="l00231"></a>00231         reset();
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233 
<a name="l00234"></a><a class="code" href="classSeExprEdTreeFilterModel.html#a14fa21807e734a7a363186293cd4dc1b">00234</a>     <span class="keywordtype">bool</span> <a class="code" href="classSeExprEdTreeFilterModel.html#a14fa21807e734a7a363186293cd4dc1b">filterAcceptsRow</a>(<span class="keywordtype">int</span> sourceRow, <span class="keyword">const</span> QModelIndex&amp; sourceParent)<span class="keyword"> const</span>
<a name="l00235"></a>00235 <span class="keyword">    </span>{
<a name="l00236"></a>00236         <span class="keywordflow">if</span>(sourceParent.isValid() &amp;&amp;
<a name="l00237"></a>00237             sourceModel()-&gt;data(sourceParent).toString().contains(filterRegExp())) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00238"></a>00238         QString data=sourceModel()-&gt;data(sourceModel()-&gt;<a class="code" href="userdoc_8txt.html#a547c3013237fcef91180e5c3fb370e14">index</a>(sourceRow,0,sourceParent)).toString();
<a name="l00239"></a>00239         <span class="keywordtype">bool</span> keep=data.contains(filterRegExp());
<a name="l00240"></a>00240 
<a name="l00241"></a>00241         QModelIndex subIndex=sourceModel()-&gt;index(sourceRow,0,sourceParent);
<a name="l00242"></a>00242         <span class="keywordflow">if</span>(subIndex.isValid()){
<a name="l00243"></a>00243             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;sourceModel()-&gt;rowCount(subIndex);++i)
<a name="l00244"></a>00244                 keep = keep || <a class="code" href="classSeExprEdTreeFilterModel.html#a14fa21807e734a7a363186293cd4dc1b">filterAcceptsRow</a>(i, subIndex);
<a name="l00245"></a>00245         }
<a name="l00246"></a>00246         <span class="keywordflow">return</span> keep;
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 };
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="classSeExprEdBrowser.html#a610213e4060c1058f409f2ab305628d2">00251</a> <a class="code" href="classSeExprEdBrowser.html#a610213e4060c1058f409f2ab305628d2">SeExprEdBrowser::~SeExprEdBrowser</a>()
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253     <span class="keyword">delete</span> <a class="code" href="classSeExprEdBrowser.html#a8e5466fd4309ceabce03d820f4db9c67">treeModel</a>;
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="classSeExprEdBrowser.html#a8b338ff1e0c07818fbca6fcb91344976">00256</a> <a class="code" href="classSeExprEdBrowser.html#a8b338ff1e0c07818fbca6fcb91344976">SeExprEdBrowser::SeExprEdBrowser</a>(QWidget* parent, <a class="code" href="classSeExprEditor.html">SeExprEditor</a>* editor)
<a name="l00257"></a>00257     :QWidget(parent),editor(editor),
<a name="l00258"></a>00258      _context(<span class="stringliteral">&quot;&quot;</span>),
<a name="l00259"></a>00259      _searchPath(<span class="stringliteral">&quot;&quot;</span>)
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261     QVBoxLayout* rootLayout = <span class="keyword">new</span> QVBoxLayout;
<a name="l00262"></a>00262     rootLayout-&gt;setMargin(0);
<a name="l00263"></a>00263     this-&gt;setLayout(rootLayout);
<a name="l00264"></a>00264     <span class="comment">// search and clear widgets</span>
<a name="l00265"></a>00265     QHBoxLayout* searchAndClearLayout=<span class="keyword">new</span> QHBoxLayout();
<a name="l00266"></a>00266     <a class="code" href="classSeExprEdBrowser.html#aa9e251430983904d819456d150f514c5">exprFilter</a>=<span class="keyword">new</span> QLineEdit();
<a name="l00267"></a>00267     connect(<a class="code" href="classSeExprEdBrowser.html#aa9e251430983904d819456d150f514c5">exprFilter</a>,SIGNAL(textChanged(<span class="keyword">const</span> QString&amp;)),SLOT(<a class="code" href="classSeExprEdBrowser.html#a49d56f10d95ce6de8ab8abd0231293e5">filterChanged</a>(<span class="keyword">const</span> QString&amp;)));
<a name="l00268"></a>00268     searchAndClearLayout-&gt;addWidget(<a class="code" href="classSeExprEdBrowser.html#aa9e251430983904d819456d150f514c5">exprFilter</a>,2);
<a name="l00269"></a>00269     QPushButton* clearFilterButton=<span class="keyword">new</span> QPushButton(<span class="stringliteral">&quot;X&quot;</span>);
<a name="l00270"></a>00270     clearFilterButton-&gt;setFixedWidth(24);
<a name="l00271"></a>00271     searchAndClearLayout-&gt;addWidget(clearFilterButton,1);
<a name="l00272"></a>00272     rootLayout-&gt;addLayout(searchAndClearLayout);
<a name="l00273"></a>00273     connect(clearFilterButton,SIGNAL(clicked()),SLOT(<a class="code" href="classSeExprEdBrowser.html#ac367d7c4ee336a4215fc3cb4ceb634e6">clearFilter</a>()));
<a name="l00274"></a>00274     <span class="comment">// model of tree</span>
<a name="l00275"></a>00275     <a class="code" href="classSeExprEdBrowser.html#a8e5466fd4309ceabce03d820f4db9c67">treeModel</a>=<span class="keyword">new</span> <a class="code" href="classSeExprEdTreeModel.html">SeExprEdTreeModel</a>();
<a name="l00276"></a>00276     <a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>=<span class="keyword">new</span> <a class="code" href="classSeExprEdTreeFilterModel.html">SeExprEdTreeFilterModel</a>(<span class="keyword">this</span>);
<a name="l00277"></a>00277     <a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>-&gt;setSourceModel(<a class="code" href="classSeExprEdBrowser.html#a8e5466fd4309ceabce03d820f4db9c67">treeModel</a>);
<a name="l00278"></a>00278     <span class="comment">// tree widget</span>
<a name="l00279"></a>00279     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>=<span class="keyword">new</span> QTreeView;
<a name="l00280"></a>00280     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;setModel(<a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>);
<a name="l00281"></a>00281     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;hideColumn(1);
<a name="l00282"></a>00282     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;setHeaderHidden(<span class="keyword">true</span>);
<a name="l00283"></a>00283     rootLayout-&gt;addWidget(<a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>);
<a name="l00284"></a>00284     <span class="comment">// selection mode and signal</span>
<a name="l00285"></a>00285     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;setSelectionMode(QAbstractItemView::SingleSelection);
<a name="l00286"></a>00286     connect(<a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;selectionModel(),SIGNAL(currentChanged(<span class="keyword">const</span> QModelIndex&amp;,<span class="keyword">const</span> QModelIndex&amp;)),SLOT(<a class="code" href="classSeExprEdBrowser.html#a9fdda164e4b3632beb67552617d79567">handleSelection</a>(<span class="keyword">const</span> QModelIndex&amp;,<span class="keyword">const</span> QModelIndex&amp;)));
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a><a class="code" href="classSeExprEdBrowser.html#a37b4dedc7e834887d918b895fb7ab52c">00289</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a37b4dedc7e834887d918b895fb7ab52c">SeExprEdBrowser::addPath</a>(<span class="keyword">const</span> std::string&amp; name,<span class="keyword">const</span> std::string&amp; path)
<a name="l00290"></a>00290 {
<a name="l00291"></a>00291     <a class="code" href="classSeExprEdBrowser.html#a818484ea845aacf864e679fd38b71ceb">labels</a>.append(QString::fromStdString(name));
<a name="l00292"></a>00292     <a class="code" href="classSeExprEdBrowser.html#a2f910f885a578ac8e70abe2a6c9c8fd4">paths</a>.append(QString::fromStdString(path));
<a name="l00293"></a>00293     <a class="code" href="classSeExprEdBrowser.html#a8e5466fd4309ceabce03d820f4db9c67">treeModel</a>-&gt;<a class="code" href="classSeExprEdTreeModel.html#a609ed8580afe42806218e3178dd5e879">addPath</a>(name.c_str(),path.c_str());
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a><a class="code" href="classSeExprEdBrowser.html#ada5f14916246bd4996971aebad76295a">00296</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#ada5f14916246bd4996971aebad76295a">SeExprEdBrowser::setSearchPath</a>(<span class="keyword">const</span> QString&amp; <a class="code" href="userdoc_8txt.html#a869a3da8a3d361c3110d09a20fe37b80">context</a>, <span class="keyword">const</span> QString&amp; path)
<a name="l00297"></a>00297 {
<a name="l00298"></a>00298     <a class="code" href="classSeExprEdBrowser.html#af4b7e9ce9bd6e2cab55ced5a4c5f2d0a">_context</a> = context.toStdString();
<a name="l00299"></a>00299     <a class="code" href="classSeExprEdBrowser.html#a050f794f8d1eaa11ba9dbaa34dc95191">_searchPath</a> = path.toStdString();
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="classSeExprEdBrowser.html#a25462b500f336e6ec47f74df1a3f692c">00302</a> std::string <a class="code" href="classSeExprEdBrowser.html#a25462b500f336e6ec47f74df1a3f692c">SeExprEdBrowser::getSelectedPath</a>()
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304     QModelIndex sel=<a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;currentIndex();
<a name="l00305"></a>00305     <span class="keywordflow">if</span>(sel.isValid()){
<a name="l00306"></a>00306         QModelIndex realCurrent=<a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>-&gt;mapToSource(sel);
<a name="l00307"></a>00307         <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* item=(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>*)realCurrent.internalPointer();
<a name="l00308"></a>00308         <span class="keywordflow">return</span> item-&gt;<a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>.toStdString();
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310     <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00311"></a>00311 }
<a name="l00312"></a>00312 
<a name="l00313"></a><a class="code" href="classSeExprEdBrowser.html#a67feb4fd8ef46dfa1ba3deba9c0ff59e">00313</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a67feb4fd8ef46dfa1ba3deba9c0ff59e">SeExprEdBrowser::selectPath</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * path)
<a name="l00314"></a>00314 {
<a name="l00315"></a>00315     QModelIndex <a class="code" href="userdoc_8txt.html#a547c3013237fcef91180e5c3fb370e14">index</a>=<a class="code" href="classSeExprEdBrowser.html#a8e5466fd4309ceabce03d820f4db9c67">treeModel</a>-&gt;<a class="code" href="classSeExprEdTreeModel.html#a15985455ffde2e3ada61136992bacd08">find</a>(path);
<a name="l00316"></a>00316     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;setCurrentIndex(<a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>-&gt;mapFromSource(index));
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="classSeExprEdBrowser.html#a7fb3aece884ec447e154094752483ed8">00319</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a7fb3aece884ec447e154094752483ed8">SeExprEdBrowser::update</a>()
<a name="l00320"></a>00320 {
<a name="l00321"></a>00321     <a class="code" href="classSeExprEdBrowser.html#a8e5466fd4309ceabce03d820f4db9c67">treeModel</a>-&gt;<a class="code" href="classSeExprEdTreeModel.html#aa9f33254c9f4b3ee5bf2ea9d07950aa4">update</a>();
<a name="l00322"></a>00322     <a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>-&gt;<a class="code" href="classSeExprEdTreeFilterModel.html#a1317a5eb96523a787d4cbfddf00b786d">update</a>();
<a name="l00323"></a>00323 }
<a name="l00324"></a>00324 
<a name="l00325"></a><a class="code" href="classSeExprEdBrowser.html#a9fdda164e4b3632beb67552617d79567">00325</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a9fdda164e4b3632beb67552617d79567">SeExprEdBrowser::handleSelection</a>(<span class="keyword">const</span> QModelIndex&amp; current,<span class="keyword">const</span> QModelIndex&amp; previous)
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327     Q_UNUSED(previous)
<a name="l00328"></a>00328     <span class="keywordflow">if</span>(current.isValid()){
<a name="l00329"></a>00329         QModelIndex realCurrent=<a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>-&gt;mapToSource(current);
<a name="l00330"></a>00330         <a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>* item=(<a class="code" href="classSeExprEdTreeItem.html">SeExprEdTreeItem</a>*)realCurrent.internalPointer();
<a name="l00331"></a>00331         QString path=item-&gt;<a class="code" href="classSeExprEdTreeItem.html#a40af4fdc2cdc33bdd5abf00534fe8780">path</a>;
<a name="l00332"></a>00332         <span class="keywordflow">if</span>(path.endsWith(<span class="stringliteral">&quot;.se&quot;</span>)){
<a name="l00333"></a>00333             std::ifstream file(path.toStdString().c_str());
<a name="l00334"></a>00334             std::string fileContents((std::istreambuf_iterator&lt;char&gt;(file)),std::istreambuf_iterator&lt;char&gt;());
<a name="l00335"></a>00335             <a class="code" href="classSeExprEdBrowser.html#aaf2d674c2188d4f6fea98d2b026469cf">editor</a>-&gt;<a class="code" href="classSeExprEditor.html#a72ad70bd8dc4be09680f9b881f6a7d45">setExpr</a>(fileContents,<span class="keyword">true</span>);
<a name="l00336"></a>00336         }
<a name="l00337"></a>00337     }
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="classSeExprEdBrowser.html#a4a0d4ab1b433821346d7087d6c9d813e">00340</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a4a0d4ab1b433821346d7087d6c9d813e">SeExprEdBrowser::clear</a>()
<a name="l00341"></a>00341 {
<a name="l00342"></a>00342     <a class="code" href="classSeExprEdBrowser.html#a818484ea845aacf864e679fd38b71ceb">labels</a>.clear();
<a name="l00343"></a>00343     <a class="code" href="classSeExprEdBrowser.html#a2f910f885a578ac8e70abe2a6c9c8fd4">paths</a>.clear();
<a name="l00344"></a>00344     <a class="code" href="classSeExprEdBrowser.html#a2783a09fc1e0ce317be539186ea5d6f3">clearSelection</a>();
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     <a class="code" href="classSeExprEdBrowser.html#a8e5466fd4309ceabce03d820f4db9c67">treeModel</a>-&gt;<a class="code" href="classSeExprEdTreeModel.html#a31cca44fa0b5846f96abcfb5f9295a6f">clear</a>();
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 
<a name="l00350"></a><a class="code" href="classSeExprEdBrowser.html#a2783a09fc1e0ce317be539186ea5d6f3">00350</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a2783a09fc1e0ce317be539186ea5d6f3">SeExprEdBrowser::clearSelection</a>()
<a name="l00351"></a>00351 {
<a name="l00352"></a>00352     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;clearSelection();
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 
<a name="l00355"></a><a class="code" href="classSeExprEdBrowser.html#ac367d7c4ee336a4215fc3cb4ceb634e6">00355</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#ac367d7c4ee336a4215fc3cb4ceb634e6">SeExprEdBrowser::clearFilter</a>()
<a name="l00356"></a>00356 {
<a name="l00357"></a>00357     <a class="code" href="classSeExprEdBrowser.html#aa9e251430983904d819456d150f514c5">exprFilter</a>-&gt;clear();
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00360"></a><a class="code" href="classSeExprEdBrowser.html#a49d56f10d95ce6de8ab8abd0231293e5">00360</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a49d56f10d95ce6de8ab8abd0231293e5">SeExprEdBrowser::filterChanged</a>(<span class="keyword">const</span> QString&amp; str)
<a name="l00361"></a>00361 {
<a name="l00362"></a>00362     <a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>-&gt;setFilterRegExp(QRegExp(str));
<a name="l00363"></a>00363     <a class="code" href="classSeExprEdBrowser.html#aa153fe7bc69530097447018a2d4b81ab">proxyModel</a>-&gt;setFilterKeyColumn(0);
<a name="l00364"></a>00364     <span class="keywordflow">if</span>(str!=<span class="stringliteral">&quot;&quot;</span>){
<a name="l00365"></a>00365         <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;expandAll();
<a name="l00366"></a>00366     }<span class="keywordflow">else</span>{
<a name="l00367"></a>00367         <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;collapseAll();
<a name="l00368"></a>00368     }
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 
<a name="l00371"></a><a class="code" href="classSeExprEdBrowser.html#a71b966576a6e5e5bc34e7cf22fda6da2">00371</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a71b966576a6e5e5bc34e7cf22fda6da2">SeExprEdBrowser::saveExpressionAs</a>()
<a name="l00372"></a>00372 {
<a name="l00373"></a>00373     QString path = QFileDialog::getSaveFileName(
<a name="l00374"></a>00374             <span class="keyword">this</span>, <span class="stringliteral">&quot;Save Expression&quot;</span>, QString::fromStdString(<a class="code" href="classSeExprEdBrowser.html#a921eaf65861bef2e5da65d9c6319012f">_userExprDir</a>),
<a name="l00375"></a>00375             <span class="stringliteral">&quot;*.se&quot;</span>);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377     <span class="keywordflow">if</span> (path.length() &gt; 0) {
<a name="l00378"></a>00378         std::ofstream file(path.toStdString().c_str());
<a name="l00379"></a>00379         <span class="keywordflow">if</span> (!file) {
<a name="l00380"></a>00380             QString msg = QString(<span class="stringliteral">&quot;Could not open file %1 for writing&quot;</span>).arg(path);
<a name="l00381"></a>00381             QMessageBox::warning(<span class="keyword">this</span>, <span class="stringliteral">&quot;Error&quot;</span>,
<a name="l00382"></a>00382                     QString(<span class="stringliteral">&quot;&lt;font face=fixed&gt;%1&lt;/font&gt;&quot;</span>)
<a name="l00383"></a>00383                     .arg(msg));
<a name="l00384"></a>00384             <span class="keywordflow">return</span>;
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386         file &lt;&lt; <a class="code" href="classSeExprEdBrowser.html#aaf2d674c2188d4f6fea98d2b026469cf">editor</a>-&gt;<a class="code" href="classSeExprEditor.html#ae84e2c84e4be2321b4d4e11102a02bae">getExpr</a>();
<a name="l00387"></a>00387         file.close();
<a name="l00388"></a>00388 
<a name="l00389"></a>00389         <a class="code" href="classSeExprEdBrowser.html#a7fb3aece884ec447e154094752483ed8">update</a>();
<a name="l00390"></a>00390         <a class="code" href="classSeExprEdBrowser.html#a67feb4fd8ef46dfa1ba3deba9c0ff59e">selectPath</a>(path.toStdString().c_str());
<a name="l00391"></a>00391     }
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00394"></a><a class="code" href="classSeExprEdBrowser.html#a49260e70246f07ccab7b47d07c626240">00394</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a49260e70246f07ccab7b47d07c626240">SeExprEdBrowser::saveLocalExpressionAs</a>()
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396     QString path = QFileDialog::getSaveFileName(
<a name="l00397"></a>00397             <span class="keyword">this</span>, <span class="stringliteral">&quot;Save Expression&quot;</span>, QString::fromStdString(<a class="code" href="classSeExprEdBrowser.html#a3e8264e29c193605f9979f9e9e6797f0">_localExprDir</a>),
<a name="l00398"></a>00398             <span class="stringliteral">&quot;*.se&quot;</span>);
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     <span class="keywordflow">if</span> (path.length() &gt; 0) {
<a name="l00401"></a>00401         std::ofstream file(path.toStdString().c_str());
<a name="l00402"></a>00402         <span class="keywordflow">if</span> (!file) {
<a name="l00403"></a>00403             QString msg = QString(<span class="stringliteral">&quot;Could not open file %1 for writing&quot;</span>).arg(path);
<a name="l00404"></a>00404             QMessageBox::warning(<span class="keyword">this</span>, <span class="stringliteral">&quot;Error&quot;</span>,
<a name="l00405"></a>00405                     QString(<span class="stringliteral">&quot;&lt;font face=fixed&gt;%1&lt;/font&gt;&quot;</span>)
<a name="l00406"></a>00406                     .arg(msg));
<a name="l00407"></a>00407             <span class="keywordflow">return</span>;
<a name="l00408"></a>00408         }
<a name="l00409"></a>00409         file &lt;&lt; <a class="code" href="classSeExprEdBrowser.html#aaf2d674c2188d4f6fea98d2b026469cf">editor</a>-&gt;<a class="code" href="classSeExprEditor.html#ae84e2c84e4be2321b4d4e11102a02bae">getExpr</a>();
<a name="l00410"></a>00410         file.close();
<a name="l00411"></a>00411 
<a name="l00412"></a>00412         <a class="code" href="classSeExprEdBrowser.html#a7fb3aece884ec447e154094752483ed8">update</a>();
<a name="l00413"></a>00413         <a class="code" href="classSeExprEdBrowser.html#a67feb4fd8ef46dfa1ba3deba9c0ff59e">selectPath</a>(path.toStdString().c_str());
<a name="l00414"></a>00414     }
<a name="l00415"></a>00415 }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 
<a name="l00418"></a><a class="code" href="classSeExprEdBrowser.html#a42725ea62351808e6625cf365fd60b95">00418</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#a42725ea62351808e6625cf365fd60b95">SeExprEdBrowser::saveExpression</a>()
<a name="l00419"></a>00419 {
<a name="l00420"></a>00420     std::string path = <a class="code" href="classSeExprEdBrowser.html#a25462b500f336e6ec47f74df1a3f692c">getSelectedPath</a>();
<a name="l00421"></a>00421     <span class="keywordflow">if</span> (path.length() == 0) {
<a name="l00422"></a>00422         <a class="code" href="classSeExprEdBrowser.html#a71b966576a6e5e5bc34e7cf22fda6da2">saveExpressionAs</a>();
<a name="l00423"></a>00423         <span class="keywordflow">return</span>;
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425     std::ofstream file(path.c_str());
<a name="l00426"></a>00426     <span class="keywordflow">if</span> (!file) {
<a name="l00427"></a>00427         QString msg = QString(<span class="stringliteral">&quot;Could not open file %1 for writing.  Is it read-only?&quot;</span>).arg(QString::fromStdString(path));
<a name="l00428"></a>00428         QMessageBox::warning(<span class="keyword">this</span>, <span class="stringliteral">&quot;Error&quot;</span>,
<a name="l00429"></a>00429                 QString(<span class="stringliteral">&quot;&lt;font face=fixed&gt;%1&lt;/font&gt;&quot;</span>)
<a name="l00430"></a>00430                 .arg(msg));
<a name="l00431"></a>00431         <span class="keywordflow">return</span>;
<a name="l00432"></a>00432     }
<a name="l00433"></a>00433     file &lt;&lt; <a class="code" href="classSeExprEdBrowser.html#aaf2d674c2188d4f6fea98d2b026469cf">editor</a>-&gt;<a class="code" href="classSeExprEditor.html#ae84e2c84e4be2321b4d4e11102a02bae">getExpr</a>();
<a name="l00434"></a>00434     file.close();
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a><a class="code" href="classSeExprEdBrowser.html#ae69532eb56f01126b8daf62b5c7a1fbc">00437</a> <span class="keywordtype">void</span> <a class="code" href="classSeExprEdBrowser.html#ae69532eb56f01126b8daf62b5c7a1fbc">SeExprEdBrowser::expandAll</a>()
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439     <a class="code" href="classSeExprEdBrowser.html#a9c39e2782ca121f57eb675ca375c2976">treeNew</a>-&gt;expandAll();
<a name="l00440"></a>00440 }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="comment">/*</span>
<a name="l00444"></a>00444 <span class="comment"> * NOTE: The hard-coded paint3d assumptions can be removed once</span>
<a name="l00445"></a>00445 <span class="comment"> * it (and bonsai?) are adjusted to call setSearchPath(context, path)</span>
<a name="l00446"></a>00446 <span class="comment"> */</span>
<a name="l00447"></a>00447 
<a name="l00448"></a><a class="code" href="classSeExprEdBrowser.html#a56551bae58e96731d5d6dba5c1d291d3">00448</a> <span class="keywordtype">bool</span> <a class="code" href="classSeExprEdBrowser.html#a56551bae58e96731d5d6dba5c1d291d3">SeExprEdBrowser::getExpressionDirs</a>()
<a name="l00449"></a>00449 {
<a name="l00450"></a>00450     <span class="keyword">const</span> <span class="keywordtype">char</span> *env;
<a name="l00451"></a>00451     <span class="keywordtype">bool</span> enableLocal = <span class="keyword">false</span>;
<a name="l00452"></a>00452     <span class="comment">/*bool homeFound = false; -- for xgen&apos;s config.txt UserRepo section below */</span>
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <span class="keywordflow">if</span> (<a class="code" href="classSeExprEdBrowser.html#a050f794f8d1eaa11ba9dbaa34dc95191">_searchPath</a>.length() &gt; 0)
<a name="l00455"></a>00455         env = <a class="code" href="classSeExprEdBrowser.html#a050f794f8d1eaa11ba9dbaa34dc95191">_searchPath</a>.c_str();
<a name="l00456"></a>00456     <span class="keywordflow">else</span>
<a name="l00457"></a>00457         env = getenv(<a class="code" href="SeExprEdBrowser_8cpp.html#a49be0f378c0e7f4e64387e0d186e6ebc">P3D_CONFIG_ENVVAR</a>); <span class="comment">/* For backwards compatibility */</span>
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="keywordflow">if</span> (!env)
<a name="l00460"></a>00460         <span class="keywordflow">return</span> enableLocal;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462     std::string <a class="code" href="userdoc_8txt.html#a869a3da8a3d361c3110d09a20fe37b80">context</a>;
<a name="l00463"></a>00463     <span class="keywordflow">if</span> (<a class="code" href="classSeExprEdBrowser.html#af4b7e9ce9bd6e2cab55ced5a4c5f2d0a">_context</a>.length() &gt; 0) {
<a name="l00464"></a>00464         context = <a class="code" href="classSeExprEdBrowser.html#af4b7e9ce9bd6e2cab55ced5a4c5f2d0a">_context</a>;
<a name="l00465"></a>00465     } <span class="keywordflow">else</span> {
<a name="l00466"></a>00466         context = <span class="stringliteral">&quot;paint3d&quot;</span>; <span class="comment">/* For backwards compatibility */</span>
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     <a class="code" href="classSeExprEdBrowser.html#a4a0d4ab1b433821346d7087d6c9d813e">clear</a>();
<a name="l00470"></a>00470 
<a name="l00471"></a>00471     std::string configFile=std::string(env)+<span class="stringliteral">&quot;/config.txt&quot;</span>;
<a name="l00472"></a>00472     std::ifstream file(configFile.c_str());
<a name="l00473"></a>00473     <span class="keywordflow">if</span>(file){
<a name="l00474"></a>00474 
<a name="l00475"></a>00475         std::string key;
<a name="l00476"></a>00476         <span class="keywordflow">while</span>(file){
<a name="l00477"></a>00477             file&gt;&gt;key;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479             <span class="keywordflow">if</span>(key[0]==<span class="charliteral">&apos;#&apos;</span>){
<a name="l00480"></a>00480                 <span class="keywordtype">char</span> buffer[1024];
<a name="l00481"></a>00481                 file.getline(buffer,1024);
<a name="l00482"></a>00482             } <span class="keywordflow">else</span> {
<a name="l00483"></a>00483                 <span class="keywordflow">if</span> (key==<span class="stringliteral">&quot;ExpressionDir&quot;</span>){
<a name="l00484"></a>00484                     std::string label,path;
<a name="l00485"></a>00485                     file&gt;&gt;label;
<a name="l00486"></a>00486                     file&gt;&gt;path;
<a name="l00487"></a>00487                     <span class="keywordflow">if</span>(QDir(QString(path.c_str())).exists())
<a name="l00488"></a>00488                         <a class="code" href="classSeExprEdBrowser.html#a37b4dedc7e834887d918b895fb7ab52c">addPath</a>(label,path);
<a name="l00489"></a>00489                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key==<span class="stringliteral">&quot;ExpressionSubDir&quot;</span>){
<a name="l00490"></a>00490                     std::string path;
<a name="l00491"></a>00491                     file&gt;&gt;path;
<a name="l00492"></a>00492                     <a class="code" href="classSeExprEdBrowser.html#a3e8264e29c193605f9979f9e9e6797f0">_localExprDir</a>=path;
<a name="l00493"></a>00493                     <span class="keywordflow">if</span>(QDir(QString(path.c_str())).exists()){
<a name="l00494"></a>00494                         <a class="code" href="classSeExprEdBrowser.html#a37b4dedc7e834887d918b895fb7ab52c">addPath</a>(<span class="stringliteral">&quot;Local&quot;</span>,<a class="code" href="classSeExprEdBrowser.html#a3e8264e29c193605f9979f9e9e6797f0">_localExprDir</a>);
<a name="l00495"></a>00495                         enableLocal=<span class="keyword">true</span>;
<a name="l00496"></a>00496                     }
<a name="l00497"></a>00497                 <span class="comment">/* These are for compatibility with xgen.</span>
<a name="l00498"></a>00498 <span class="comment">                 * Long-term, xgen should use the same format.</span>
<a name="l00499"></a>00499 <span class="comment">                 * Longer-term, we should use JSON or something */</span>
<a name="l00500"></a>00500                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;GlobalRepo&quot;</span>) {
<a name="l00501"></a>00501                     std::string path;
<a name="l00502"></a>00502                     file&gt;&gt;path;
<a name="l00503"></a>00503                     path += <span class="stringliteral">&quot;/expressions/&quot;</span>;
<a name="l00504"></a>00504                     <span class="keywordflow">if</span>(QDir(QString(path.c_str())).exists())
<a name="l00505"></a>00505                         <a class="code" href="classSeExprEdBrowser.html#a37b4dedc7e834887d918b895fb7ab52c">addPath</a>(<span class="stringliteral">&quot;Global&quot;</span>, path);
<a name="l00506"></a>00506                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key == <span class="stringliteral">&quot;LocalRepo&quot;</span>) {
<a name="l00507"></a>00507                     std::string path;
<a name="l00508"></a>00508                     file&gt;&gt;path;
<a name="l00509"></a>00509                     path += <span class="stringliteral">&quot;/expressions/&quot;</span>;
<a name="l00510"></a>00510                     <a class="code" href="classSeExprEdBrowser.html#a3e8264e29c193605f9979f9e9e6797f0">_localExprDir</a>=path;
<a name="l00511"></a>00511                     <span class="keywordflow">if</span>(QDir(QString(path.c_str())).exists()){
<a name="l00512"></a>00512                         <a class="code" href="classSeExprEdBrowser.html#a37b4dedc7e834887d918b895fb7ab52c">addPath</a>(<span class="stringliteral">&quot;Local&quot;</span>,<a class="code" href="classSeExprEdBrowser.html#a3e8264e29c193605f9979f9e9e6797f0">_localExprDir</a>);
<a name="l00513"></a>00513                         enableLocal=<span class="keyword">true</span>;
<a name="l00514"></a>00514                     }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516                 <span class="comment">/*</span>
<a name="l00517"></a>00517 <span class="comment">                 * xgen&apos;s config.txt has a &quot;UserRepo&quot; section but we</span>
<a name="l00518"></a>00518 <span class="comment">                 * intentionally ignore it since we already add the user dir</span>
<a name="l00519"></a>00519 <span class="comment">                 * down where the HOME stuff is handled</span>
<a name="l00520"></a>00520 <span class="comment">                 */</span>
<a name="l00521"></a>00521 
<a name="l00522"></a>00522                 <span class="comment">/*</span>
<a name="l00523"></a>00523 <span class="comment">                } else if (key == &quot;UserRepo&quot;) {</span>
<a name="l00524"></a>00524 <span class="comment">                    std::string path;</span>
<a name="l00525"></a>00525 <span class="comment">                    file&gt;&gt;path;</span>
<a name="l00526"></a>00526 <span class="comment">                    path += &quot;/expressions/&quot;;</span>
<a name="l00527"></a>00527 <span class="comment"></span>
<a name="l00528"></a>00528 <span class="comment">                    size_t found = path.find(&quot;${HOME}&quot;);</span>
<a name="l00529"></a>00529 <span class="comment"></span>
<a name="l00530"></a>00530 <span class="comment">                    if (found != std::string::npos) {</span>
<a name="l00531"></a>00531 <span class="comment">                        char *homepath = getenv(&quot;HOME&quot;);</span>
<a name="l00532"></a>00532 <span class="comment">                        if (homepath) {</span>
<a name="l00533"></a>00533 <span class="comment">                            path.replace(found, strlen(&quot;${HOME}&quot;), homepath);</span>
<a name="l00534"></a>00534 <span class="comment">                        } else {</span>
<a name="l00535"></a>00535 <span class="comment">                            continue;</span>
<a name="l00536"></a>00536 <span class="comment">                        }</span>
<a name="l00537"></a>00537 <span class="comment">                    }</span>
<a name="l00538"></a>00538 <span class="comment">                    if(QDir(QString(path.c_str())).exists()){</span>
<a name="l00539"></a>00539 <span class="comment">                        addPath(&quot;User&quot;, path);</span>
<a name="l00540"></a>00540 <span class="comment">                        homeFound = true;</span>
<a name="l00541"></a>00541 <span class="comment">                    }</span>
<a name="l00542"></a>00542 <span class="comment">                */</span>
<a name="l00543"></a>00543                 } <span class="keywordflow">else</span>{
<a name="l00544"></a>00544                     <span class="keywordtype">char</span> buffer[1024];
<a name="l00545"></a>00545                     file.getline(buffer,1024);
<a name="l00546"></a>00546                 }
<a name="l00547"></a>00547             }
<a name="l00548"></a>00548         }
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550     <span class="comment">/* TODO refactor! */</span>
<a name="l00551"></a>00551     <span class="keywordtype">char</span>* homepath = getenv(<span class="stringliteral">&quot;HOME&quot;</span>);
<a name="l00552"></a>00552     <span class="keywordflow">if</span>(homepath){
<a name="l00553"></a>00553         std::string path= std::string(homepath) + <span class="stringliteral">&quot;/&quot;</span> + context + <span class="stringliteral">&quot;/expressions/&quot;</span>;
<a name="l00554"></a>00554         <span class="keywordflow">if</span>(QDir(QString(path.c_str())).exists()){
<a name="l00555"></a>00555             <a class="code" href="classSeExprEdBrowser.html#a921eaf65861bef2e5da65d9c6319012f">_userExprDir</a>=path;
<a name="l00556"></a>00556             <a class="code" href="classSeExprEdBrowser.html#a37b4dedc7e834887d918b895fb7ab52c">addPath</a>(<span class="stringliteral">&quot;My Expressions&quot;</span>,path);
<a name="l00557"></a>00557         }
<a name="l00558"></a>00558     }
<a name="l00559"></a>00559     <a class="code" href="classSeExprEdBrowser.html#a7fb3aece884ec447e154094752483ed8">update</a>();
<a name="l00560"></a>00560     <span class="keywordflow">return</span> enableLocal;
<a name="l00561"></a>00561 }
<a name="l00562"></a>00562 
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 25 Jul 2013 for SeExpr by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
