set(LLVM_DIR "/usr/share/llvm/cmake")
FIND_PACKAGE(LLVM REQUIRED CONFIG NAMES LLVM-)
message(STATUS "Using LLVM-Config.cmake in: ${LLVM_DIR}")
find_program(LLVM_CONFIG_EXECUTABLE NAMES llvm-config)

# Uncomment to use clang++
#set(CMAKE_CXX_COMPILER clang++)
#set(CMAKE_C_COMPILER clang)

set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${LLVM_DIR}")
include(LLVM-Config)
include(HandleLLVMOptions)

add_definitions( ${LLVM_DEFINITIONS} )
message(STATUS "LLVM_DEFINITIONS =" ${LLVM_DEFINITIONS})

execute_process(
    COMMAND ${LLVM_CONFIG_EXECUTABLE} --ldflags
    OUTPUT_VARIABLE LLVM_LDFLAGS
    OUTPUT_STRIP_TRAILING_WHITESPACE
)
message(STATUS "LLVM_LDFLAGS = " ${LLVM_LDFLAGS})

set(CMAKE_SHARED_LINKER_FLAGS "${CMAKE_SHARED_LINKER_FLAGS} ${LLVM_LDFLAGS}" CACHE STRING "" FORCE)
set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} ${LLVM_LDFLAGS}" CACHE STRING "" FORCE)
